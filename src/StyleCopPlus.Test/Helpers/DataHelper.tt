<#@ template debug="true" hostspecific="true" language="C#" #>
<#@ output extension=".Generated.cs" #>
<#@ assembly name="System.Core" #>
<#@ assembly name="EnvDTE" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="EnvDTE" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Collections.Generic" #>
//------------------------------------------------------------------------------
// <auto-generated>
// Data access layer code generator.
// </auto-generated>
//------------------------------------------------------------------------------
using System.CodeDom.Compiler;

namespace StyleCopPlus.Test.Helpers
{
    [GeneratedCode("TestHelperGenerator", "1.0")]
    public static partial class DataHelper
    {
<#
    PushIndent("        ");
    string testDataPath = this.Host.ResolvePath("..\\Playground");
    string[] files = Directory.GetFiles(testDataPath, "*.cs", SearchOption.AllDirectories);

    foreach (string file in files)
    {
        string fileName = Path.GetFileName(file);
        if (fileName.StartsWith("Temp"))
            continue;

        string folderName = Path.GetFileName(Path.GetDirectoryName(file));
        string resourceName = folderName + "." + fileName;
        string constantName = folderName + Path.GetFileNameWithoutExtension(file);

        WriteLine($"public const string {constantName} = \"{resourceName}\";");
    }

    ClearIndent();
#>
    }
}